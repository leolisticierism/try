<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2022.44">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #2b9543; -webkit-text-stroke: #2b9543}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #286daf; -webkit-text-stroke: #286daf}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #000000; -webkit-text-stroke: #000000; min-height: 14.0px}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #000000; -webkit-text-stroke: #000000}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #dd3f0e; -webkit-text-stroke: #dd3f0e}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #6154a1; -webkit-text-stroke: #6154a1}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #505050; -webkit-text-stroke: #505050}
    span.s1 {font-kerning: none}
    span.s2 {font-kerning: none; color: #dd3f0e; -webkit-text-stroke: 0px #dd3f0e}
    span.s3 {font-kerning: none; color: #6154a1; -webkit-text-stroke: 0px #6154a1}
    span.s4 {font-kerning: none; color: #2b9543; -webkit-text-stroke: 0px #2b9543}
    span.s5 {font-kerning: none; color: #000000; -webkit-text-stroke: 0px #000000}
    span.s6 {font-kerning: none; color: #286daf; -webkit-text-stroke: 0px #286daf}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p2"><span class="s1">&lt;meta </span><span class="s2">charset</span><span class="s1">=</span><span class="s3">"utf-8"</span><span class="s1">&gt;</span></p>
<p class="p2"><span class="s1">&lt;style&gt;</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s1">@import url(https://fonts.googleapis.com/css?family=Open+Sans+Condensed:</span><span class="s4">300</span><span class="s1">|Josefin+Slab|Arvo|Lato|Vollkorn|Abril+Fatface|Old+Standard+TT|Droid+Sans|Lobster|Inconsolata|Montserrat|Playfair+Display|Karla|Alegreya|Libre+Baskerville|Merriweather|Lora|Archivo+Narrow|Neuton|Signika|Questrial|Fjalla+One|Bitter|Varela+Round);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">.background</span><span class="s5"> {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s2">fill</span><span class="s1">: </span><span class="s4">#eee</span><span class="s1">;</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">pointer-events</span><span class="s5">: all;</span></p>
<p class="p4"><span class="s1">}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">.map-layer</span><span class="s5"> {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s2">fill</span><span class="s1">: </span><span class="s4">#fff</span><span class="s1">;</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">stroke</span><span class="s5">: </span><span class="s4">#aaa</span><span class="s5">;</span></p>
<p class="p4"><span class="s1">}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">.effect-layer</span><span class="s5">{</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">pointer-events</span><span class="s5">:none;</span></p>
<p class="p4"><span class="s1">}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">text</span><span class="s5">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s2">font-family</span><span class="s1">: </span><span class="s3">'Helvetica Neue'</span><span class="s1">, Helvetica, Arial, sans-serif;</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">font-weight</span><span class="s5">: </span><span class="s4">300</span><span class="s5">;</span></p>
<p class="p4"><span class="s1">}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">text.big-text</span><span class="s5">{</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">font-size</span><span class="s5">: </span><span class="s4">30px</span><span class="s5">;</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">font-weight</span><span class="s5">: </span><span class="s4">400</span><span class="s5">;</span></p>
<p class="p4"><span class="s1">}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">.effect-layer</span><span class="s5"> </span><span class="s1">text</span><span class="s5">, </span><span class="s1">text.dummy-text</span><span class="s5">{</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">font-size</span><span class="s5">: </span><span class="s4">12px</span><span class="s5">;</span></p>
<p class="p4"><span class="s1">}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">&lt;/style&gt;</span></p>
<p class="p2"><span class="s1">&lt;body&gt;</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">&lt;svg&gt;&lt;/svg&gt;</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p6"><span class="s6">&lt;script </span><span class="s2">src</span><span class="s6">=</span><span class="s1">"https://d3js.org/d3.v3.min.js"</span><span class="s6">&gt;&lt;/script&gt;</span></p>
<p class="p2"><span class="s1">&lt;script&gt;</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s6">var</span><span class="s1"> width = </span><span class="s4">960</span><span class="s1">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>height = </span><span class="s4">500</span><span class="s1">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>centered;</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">// Define color scale</span></p>
<p class="p4"><span class="s6">var</span><span class="s1"> color = d3.scale.linear()</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.domain([</span><span class="s4">1</span><span class="s1">, </span><span class="s4">20</span><span class="s1">])</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.clamp(true)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.range([</span><span class="s3">'#fff'</span><span class="s1">, </span><span class="s3">'#409A99'</span><span class="s1">]);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s6">var</span><span class="s1"> projection = d3.geo.mercator()</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.scale(</span><span class="s4">45000</span><span class="s1">)</span></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Center the Map in Colombia</span></p>
<p class="p1"><span class="s5"><span class="Apple-converted-space">  </span>.center([</span><span class="s1">-73.935242</span><span class="s5">, </span><span class="s1">40.730610</span><span class="s5">])</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.translate([width / </span><span class="s4">2</span><span class="s1">, height / </span><span class="s4">2</span><span class="s1">]);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s6">var</span><span class="s1"> path = d3.geo.path()</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.projection(projection);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">// Set svg width &amp; height</span></p>
<p class="p4"><span class="s6">var</span><span class="s1"> svg = d3.select(</span><span class="s3">'svg'</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.attr(</span><span class="s3">'width'</span><span class="s1">, width)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.attr(</span><span class="s3">'height'</span><span class="s1">, height);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">// Add background</span></p>
<p class="p4"><span class="s1">svg.append(</span><span class="s3">'rect'</span><span class="s1">)</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span>.attr(</span><span class="s1">'class'</span><span class="s5">, </span><span class="s1">'background'</span><span class="s5">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.attr(</span><span class="s3">'width'</span><span class="s1">, width)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.attr(</span><span class="s3">'height'</span><span class="s1">, height)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.on(</span><span class="s3">'click'</span><span class="s1">, clicked);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s6">var</span><span class="s1"> g = svg.append(</span><span class="s3">'g'</span><span class="s1">);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s6">var</span><span class="s1"> effectLayer = g.append(</span><span class="s3">'g'</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.classed(</span><span class="s3">'effect-layer'</span><span class="s1">, true);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s6">var</span><span class="s1"> mapLayer = g.append(</span><span class="s3">'g'</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.classed(</span><span class="s3">'map-layer'</span><span class="s1">, true);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s6">var</span><span class="s1"> dummyText = g.append(</span><span class="s3">'text'</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.classed(</span><span class="s3">'dummy-text'</span><span class="s1">, true)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.attr(</span><span class="s3">'x'</span><span class="s1">, </span><span class="s4">10</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.attr(</span><span class="s3">'y'</span><span class="s1">, </span><span class="s4">30</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.style(</span><span class="s3">'opacity'</span><span class="s1">, </span><span class="s4">0</span><span class="s1">);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s6">var</span><span class="s1"> bigText = g.append(</span><span class="s3">'text'</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.classed(</span><span class="s3">'big-text'</span><span class="s1">, true)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.attr(</span><span class="s3">'x'</span><span class="s1">, </span><span class="s4">20</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>.attr(</span><span class="s3">'y'</span><span class="s1">, </span><span class="s4">45</span><span class="s1">);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">// Load map data</span></p>
<p class="p4"><span class="s1">d3.json(</span><span class="s3">‘School Districts.geojson'</span><span class="s1">, </span><span class="s6">function</span><span class="s1">(error, mapData) {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> features = mapData.features;</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Update color scale domain based on data</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>color.domain([</span><span class="s4">0</span><span class="s1">, d3.max(features, nameLength)]);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Draw each province as a path</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>mapLayer.selectAll(</span><span class="s3">'path'</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>.data(features)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.enter().append(</span><span class="s3">'path'</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>.attr(</span><span class="s3">'d'</span><span class="s1">, path)</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">      </span>.attr(</span><span class="s1">'vector-effect'</span><span class="s5">, </span><span class="s1">'non-scaling-stroke'</span><span class="s5">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>.style(</span><span class="s3">'fill'</span><span class="s1">, fillFn)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>.on(</span><span class="s3">'mouseover'</span><span class="s1">, mouseover)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>.on(</span><span class="s3">'mouseout'</span><span class="s1">, mouseout)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>.on(</span><span class="s3">'click'</span><span class="s1">, clicked);</span></p>
<p class="p4"><span class="s1">});</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">// Get province name</span></p>
<p class="p4"><span class="s6">function</span><span class="s1"> nameFn(d){</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">return</span><span class="s1"> d &amp;&amp; d.properties ? d.properties.boro_name : null;</span></p>
<p class="p4"><span class="s1">}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">// Get province name length</span></p>
<p class="p4"><span class="s6">function</span><span class="s1"> nameLength(d){</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> n = nameFn(d);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">return</span><span class="s1"> n ? n.length : </span><span class="s4">0</span><span class="s1">;</span></p>
<p class="p4"><span class="s1">}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">// Get province color</span></p>
<p class="p4"><span class="s6">function</span><span class="s1"> fillFn(d){</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">return</span><span class="s1"> color(nameLength(d));</span></p>
<p class="p4"><span class="s1">}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">// When clicked, zoom in</span></p>
<p class="p4"><span class="s6">function</span><span class="s1"> clicked(d) {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> x, y, k;</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Compute centroid of the selected path</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">if</span><span class="s1"> (d &amp;&amp; centered !== d) {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s6">var</span><span class="s1"> centroid = path.centroid(d);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>x = centroid[</span><span class="s4">0</span><span class="s1">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>y = centroid[</span><span class="s4">1</span><span class="s1">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>k = </span><span class="s4">4</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>centered = d;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>} </span><span class="s6">else</span><span class="s1"> {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>x = width / </span><span class="s4">2</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>y = height / </span><span class="s4">2</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>k = </span><span class="s4">1</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>centered = null;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Highlight the clicked province</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>mapLayer.selectAll(</span><span class="s3">'path'</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.style(</span><span class="s3">'fill'</span><span class="s1">, </span><span class="s6">function</span><span class="s1">(d){</span><span class="s6">return</span><span class="s1"> centered &amp;&amp; d===centered ? </span><span class="s3">'#D5708B'</span><span class="s1"> : fillFn(d);});</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Zoom</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>g.transition()</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.duration(</span><span class="s4">750</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.attr(</span><span class="s3">'transform'</span><span class="s1">, </span><span class="s3">'translate('</span><span class="s1"> + width / </span><span class="s4">2</span><span class="s1"> + </span><span class="s3">','</span><span class="s1"> + height / </span><span class="s4">2</span><span class="s1"> + </span><span class="s3">')scale('</span><span class="s1"> + k + </span><span class="s3">')translate('</span><span class="s1"> + -x + </span><span class="s3">','</span><span class="s1"> + -y + </span><span class="s3">')'</span><span class="s1">);</span></p>
<p class="p4"><span class="s1">}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s6">function</span><span class="s1"> mouseover(d){</span></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Highlight hovered province</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>d3.select(</span><span class="s6">this</span><span class="s1">).style(</span><span class="s3">'fill'</span><span class="s1">, </span><span class="s3">'orange'</span><span class="s1">);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Draw effects</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>textArt(nameFn(d));</span></p>
<p class="p4"><span class="s1">}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s6">function</span><span class="s1"> mouseout(d){</span></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Reset province color</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>mapLayer.selectAll(</span><span class="s3">'path'</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.style(</span><span class="s3">'fill'</span><span class="s1">, </span><span class="s6">function</span><span class="s1">(d){</span><span class="s6">return</span><span class="s1"> centered &amp;&amp; d===centered ? </span><span class="s3">'#D5708B'</span><span class="s1"> : fillFn(d);});</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Remove effect text</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>effectLayer.selectAll(</span><span class="s3">'text'</span><span class="s1">).transition()</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.style(</span><span class="s3">'opacity'</span><span class="s1">, </span><span class="s4">0</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.remove();</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Clear province name</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>bigText.text(</span><span class="s3">''</span><span class="s1">);</span></p>
<p class="p4"><span class="s1">}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">// Gimmick</span></p>
<p class="p7"><span class="s1">// Just me playing around.</span></p>
<p class="p7"><span class="s1">// You won't need this for a regular map.</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p6"><span class="s6">var</span><span class="s5"> BASE_FONT = </span><span class="s1">"'Helvetica Neue', Helvetica, Arial, sans-serif"</span><span class="s5">;</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s6">var</span><span class="s1"> FONTS = [</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Open Sans"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Josefin Slab"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Arvo"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Lato"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Vollkorn"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Abril Fatface"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Old StandardTT"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Droid+Sans"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Lobster"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Inconsolata"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Montserrat"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Playfair Display"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Karla"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Alegreya"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Libre Baskerville"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Merriweather"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Lora"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Archivo Narrow"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Neuton"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Signika"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Questrial"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Fjalla One"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Bitter"</span><span class="s5">,</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">"Varela Round"</span></p>
<p class="p4"><span class="s1">];</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s6">function</span><span class="s1"> textArt(text){</span></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Use random font</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> fontIndex = Math.round(Math.random() * FONTS.length);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> fontFamily = FONTS[fontIndex] + </span><span class="s3">', '</span><span class="s1"> + BASE_FONT;</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>bigText</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.style(</span><span class="s3">'font-family'</span><span class="s1">, fontFamily)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.text(text);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Use dummy text to compute actual width of the text</span></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// getBBox() will return bounding box</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>dummyText</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.style(</span><span class="s3">'font-family'</span><span class="s1">, fontFamily)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.text(text);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> bbox = dummyText.node().getBBox();</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> textWidth = bbox.width;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> textHeight = bbox.height;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> xGap = </span><span class="s4">3</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> yGap = </span><span class="s4">1</span><span class="s1">;</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Generate the positions of the text in the background</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> xPtr = </span><span class="s4">0</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> yPtr = </span><span class="s4">0</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> positions = [];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> rowCount = </span><span class="s4">0</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">while</span><span class="s1">(yPtr &lt; height){</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s6">while</span><span class="s1">(xPtr &lt; width){</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s6">var</span><span class="s1"> point = {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s2">text</span><span class="s1">: text,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s2">index</span><span class="s1">: positions.length,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s2">x</span><span class="s1">: xPtr,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s2">y</span><span class="s1">: yPtr</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s6">var</span><span class="s1"> dx = point.x - width/</span><span class="s4">2</span><span class="s1"> + textWidth/</span><span class="s4">2</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s6">var</span><span class="s1"> dy = point.y - height/</span><span class="s4">2</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>point.distance = dx*dx + dy*dy;</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>positions.push(point);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>xPtr += textWidth + xGap;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>rowCount++;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>xPtr = rowCount%</span><span class="s4">2</span><span class="s1">===</span><span class="s4">0</span><span class="s1"> ? </span><span class="s4">0</span><span class="s1"> : -textWidth/</span><span class="s4">2</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>xPtr += Math.random() * </span><span class="s4">10</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>yPtr += textHeight + yGap;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s6">var</span><span class="s1"> selection = effectLayer.selectAll(</span><span class="s3">'text'</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.data(positions, </span><span class="s6">function</span><span class="s1">(d){</span><span class="s6">return</span><span class="s1"> d.text+</span><span class="s3">'/'</span><span class="s1">+d.index;});</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Clear old ones</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>selection.exit().transition()</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.style(</span><span class="s3">'opacity'</span><span class="s1">, </span><span class="s4">0</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.remove();</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Create text but set opacity to 0</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>selection.enter().append(</span><span class="s3">'text'</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.text(</span><span class="s6">function</span><span class="s1">(d){</span><span class="s6">return</span><span class="s1"> d.text;})</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.attr(</span><span class="s3">'x'</span><span class="s1">, </span><span class="s6">function</span><span class="s1">(d){</span><span class="s6">return</span><span class="s1"> d.x;})</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.attr(</span><span class="s3">'y'</span><span class="s1">, </span><span class="s6">function</span><span class="s1">(d){</span><span class="s6">return</span><span class="s1"> d.y;})</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.style(</span><span class="s3">'font-family'</span><span class="s1">, fontFamily)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.style(</span><span class="s3">'fill'</span><span class="s1">, </span><span class="s3">'#777'</span><span class="s1">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.style(</span><span class="s3">'opacity'</span><span class="s1">, </span><span class="s4">0</span><span class="s1">);</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>selection</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.style(</span><span class="s3">'font-family'</span><span class="s1">, fontFamily)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.attr(</span><span class="s3">'x'</span><span class="s1">, </span><span class="s6">function</span><span class="s1">(d){</span><span class="s6">return</span><span class="s1"> d.x;})</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.attr(</span><span class="s3">'y'</span><span class="s1">, </span><span class="s6">function</span><span class="s1">(d){</span><span class="s6">return</span><span class="s1"> d.y;});</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Create transtion to increase opacity from 0 to 0.1-0.5</span></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s1">// Add delay based on distance from the center of the &lt;svg&gt; and a bit more randomness.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span>selection.transition()</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.delay(</span><span class="s6">function</span><span class="s1">(d){</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s6">return</span><span class="s1"> d.distance * </span><span class="s4">0.01</span><span class="s1"> + Math.random()*</span><span class="s4">1000</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>})</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>.style(</span><span class="s3">'opacity'</span><span class="s1">, </span><span class="s6">function</span><span class="s1">(d){</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s6">return</span><span class="s1"> </span><span class="s4">0.1</span><span class="s1"> + Math.random()*</span><span class="s4">0.4</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p4"><span class="s1">}</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">&lt;/script&gt;</span></p>
</body>
</html>
